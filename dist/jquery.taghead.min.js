/*
 *  jQuery TagHead - v3.3.4
 *  A jQuery plugin to mix typhead and tags
 *  
 *
 *  Made by Caligone
 *  Under MIT License
 */
(function(){!function(a){var b,c,d;return d="taghead",c={remote:{enable:!1,source:"",method:"GET",sentParam:"value",displayData:"value",storeData:"value",minLength:2,forceValid:!1},allowDuplicates:!1,style:{wrapperClass:"",tagClass:"",tagListWrapperClass:"",tagListClass:"",tagListItemClass:"",inputClass:"",removeClass:""},text:{phAddTag:"Add a tag"}},b=function(){function b(b,e){this.element=b,this.settings=a.extend(!0,this.settings,c,e),this._defaults=c,this._name=d,this.tags=[],this.ids=[],this.init()}return b.prototype.init=function(){var b,c,d,e,f,g,h,i;if(a(this.element).wrap("<span class='taghead-wrapper "+this.settings.style.wrapperClass+"'></span>"),this.wrapper=a(this.element).parent()[0],a(this.wrapper).append("<input type='text' class='taghead-input "+this.settings.style.inputClass+"' placeholder='"+this.settings.text.phAddTag+"'/>"),this.input=a(this.wrapper).find(".taghead-input")[0],a(this.wrapper).append("<span class='taghead-tag-list-wrapper "+this.settings.style.tagListWrapperClass+"'><ul class='taghead-tag-list "+this.settings.style.tagListClass+"'></ul></span>"),this.list=a(this.wrapper).find(".taghead-tag-list")[0],a(this.element).hide(),a(this.list).hide(),""!==a(this.element).val())if(a(this.element).data("tags")&&""!==a(this.element).data("tags"))for(d=a(this.element).data("tags").split(","),c=a(this.element).val().split(","),b=f=0,h=d.length;h>f;b=++f)e=d[b],this.addTag(e,c[b]);else for(d=a(this.element).val().split(","),g=0,i=d.length;i>g;g++)e=d[g],this.addTag(e,e);return a(this.input).on("keyup",function(b){return function(c){var d;if(13===c.keyCode){if(b.settings.remote.forceValid)return;b.addTag(a(b.input).val(),a(b.input).val()),a(b.input).val(""),a(b.list).empty(),a(b.list).hide()}if(!(a(b.input).val().length<b.settings.remote.minLength))return b.settings.remote.enable?(d={},d[b.settings.remote.sentParam]=a(b.input).val(),a.ajax({type:b.settings.remote.method,url:b.settings.remote.source,data:d}).done(function(c){var d,e,f;for(a(b.list).empty(),e=0,f=c.length;f>e;e++)d=c[e],a(b.list).append("<li><a href='#' data-id='"+d[b.settings.remote.storeData]+"' class='taghead-tag-list-item "+b.settings.style.tagListItemClass+"'>"+d[b.settings.remote.displayData]+"</a></li>");return a(b.list).show(),a(b.element).trigger("taghead.remoteresponse")})):void 0}}(this)),a(this.input).on("keydown",function(b){return function(c){return 8===c.keyCode&&0===a(b.input).val().length?b.removeTag(b.tags[b.tags.length-1]):void 0}}(this)),a(this.wrapper).on("click","a.taghead-remove",function(b){return function(c){var d;return d=a(c.target).parent().text().slice(0,-1),b.removeTag(d),c.preventDefault()}}(this)),a(this.wrapper).on("click","a.taghead-tag-list-item",function(b){return function(c){return b.addTag(a(c.target).text(),a(c.target).attr("data-id")),a(b.list).empty(),a(b.list).hide(),a(b.input).val(""),a(b.element).trigger("taghead.addbyclick"),c.preventDefault()}}(this))},b.prototype.addTag=function(b,c){return this.settings.allowDuplicates||!(this.tags.indexOf(b)>-1||this.ids.indexOf(c)>-1)?(a(this.input).before("<span class='taghead-tag "+this.settings.style.tagClass+"' data-label='"+b+"' data-id="+c+">"+b+"<a href='#' class='taghead-remove "+this.settings.style.removeClass+"'>X</a></span>"),this.tags.push(b),this.ids.push(c),a(this.element).val(this.ids.join(",")),a(this.element).trigger("taghead.addtag")):void 0},b.prototype.removeTag=function(b,c){var d,e;return d=null!=c?this.ids.indexOf(c):this.tags.indexOf(b),d>-1&&(this.tags.splice(d,1),this.ids.splice(d,1),e=a(this.wrapper).find(".taghead-tag[data-label='"+b+"']"),e.hasClass(this.settings.style.tagClass))?(e.remove(),a(this.element).val(this.ids.join(",")),a(this.element).trigger("taghead.removetag")):void 0},b}(),a.fn[d]=function(e){return this.each(function(){var f;return a.data(this,"plugin_"+d)?void 0:(f=a.extend(!0,c,e),a.data(this,"plugin_"+d,new b(this,f)))})}}(jQuery,window,document)}).call(this);